<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        /* Basic styling generated with chatGPT */
        /* Logic and HTML is more important than design here */
        body {
    font-family: Arial, sans-serif;
    background-color: #f5f5f5;
    margin: 20px;
}

h1 {
    margin-bottom: 20px;
}

form {
    background: #ffffff;
    border: 1px solid #ccc;
    padding: 15px 20px;
    margin-bottom: 25px;
    max-width: 400px;
    border-radius: 5px;
}

label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
}

input[type="text"],
input[type="number"],
input[type="email"],
input[type="file"],
select {
    width: 100%;
    padding: 6px;
    margin-top: 5px;
    border: 1px solid #aaa;
    border-radius: 4px;
    box-sizing: border-box;
    background-color: #fafafa;
}

input[type="submit"],
input[type="button"] {
    margin-top: 15px;
    padding: 8px 14px;
    border: 1px solid #888;
    background-color: #e9e9e9;
    cursor: pointer;
    border-radius: 4px;
}

input[type="submit"]:hover,
input[type="button"]:hover {
    background-color: #dcdcdc;
}
table {
    width: 100%;
    max-width: 600px;
    border-collapse: collapse;
    margin-top: 20px;
    background: #fff;
}

th, td {
    padding: 8px;
    border: 1px solid #ccc;
}

th {
    background: #eee;
    font-weight: bold;
}

    </style>
</head>
<body>
    <h1>Új hallgató hozzáadása</h1>
    <form>
        <label for="name">Név:</label>
        <input type="text" id="name" name="name" required><br><br>
        
        <label for="age">Életkor:</label>
        <input type="number" id="age" name="age" required><br><br>
        
        <label for="major">Szak:</label>
        <input type="text" id="major" name="major" required><br><br>
        
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required><br><br>

        <label for="id">NEPTUN kód:</label>
        <input type="text" id="id" name="id" required><br><br>

        <input type="submit" value="Mentés">
    </form>
    <form>
        <label for="search">Keresés:</label>
        <input type="text" id="search" name="search">

        <label for="sort">Rendezés:</label>       
        <select id="sort" name="sort">
            <option value="name">Név</option>
            <option value="class">Évfolyam</option>
        </select>

        <label for="import_export">Export / import JSON</label>
        <inpiut type="button" value="Export JSON">
        <input type="file" id="import_export" name="import_export" accept=".json">
    </form>
    <h2>Hallgatók listája</h2>
<table id="resultTable">
    <thead>
        <tr>
            <th>Név</th>
            <th>Életkor</th>
            <th>Szak</th>
            <th>Email</th>
            <th>Neptun</th>
        </tr>
    </thead>
    <tbody>
        <!-- Rows will be inserted by JavaScript -->
    </tbody>

    <script>
    let students = [];

    // Renders the table based on current students + search filter
    function renderTable() {
        const tbody = document.querySelector("#resultTable tbody");
        const searchText = document.getElementById("search").value.toLowerCase();

        tbody.innerHTML = ""; // clear

        const filtered = students.filter(s =>
            s.name.toLowerCase().includes(searchText) ||
            s.major.toLowerCase().includes(searchText) ||
            s.id.toLowerCase().includes(searchText)
        );

        filtered.forEach(s => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>${s.name}</td>
                <td>${s.age}</td>
                <td>${s.major}</td>
                <td>${s.email}</td>
                <td>${s.id}</td>
            `;
            tbody.appendChild(row);
        });
    }

    // --- Add new student ---
    document.querySelector("form").addEventListener("submit", function (e) {
        e.preventDefault();

        const student = {
            name: document.getElementById("name").value,
            age: Number(document.getElementById("age").value),
            major: document.getElementById("major").value,
            email: document.getElementById("email").value,
            id: document.getElementById("id").value
        };

        students.push(student);
        renderTable();
        alert("Hallgató mentve!");
    });

    // --- Export JSON ---
    function exportJSON() {
        const dataStr = JSON.stringify(students, null, 2);
        const blob = new Blob([dataStr], { type: "application/json" });
        const url = URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = "students.json";
        a.click();

        URL.revokeObjectURL(url);
    }

    document.querySelector('input[type="button"]').addEventListener("click", exportJSON);

    // --- Import JSON ---
    document.getElementById("import_export").addEventListener("change", function () {
        const file = this.files[0];
        if (!file) return;

        const reader = new FileReader();

        reader.onload = function (e) {
            try {
                const data = JSON.parse(e.target.result);
                if (Array.isArray(data)) {
                    students = data;
                    alert("JSON importálva!");
                    renderTable();
                } else {
                    alert("Hibás JSON!");
                }
            } catch {
                alert("Hiba a JSON feldolgozásakor!");
            }
        };

        reader.readAsText(file);
    });

    // --- Search ---
    document.getElementById("search").addEventListener("input", renderTable);

    // --- Sorting ---
    document.getElementById("sort").addEventListener("change", function () {
        const type = this.value;

        if (type === "name") {
            students.sort((a, b) => a.name.localeCompare(b.name));
        } else if (type === "class") {
            students.sort((a, b) => a.age - b.age); // Example
        }

        renderTable();
    });
</script>

</body>
</html>